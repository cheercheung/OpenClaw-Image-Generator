Use the Bash tool to generate an image via the Evolink Z-Image-Turbo API.

## Prerequisites — API Key

Before generating, check if the environment variable `EVOLINK_API_KEY` is set:
- Windows: `echo %EVOLINK_API_KEY%`
- Unix: `echo $EVOLINK_API_KEY`

- If it is **empty or not set**, ask the user to provide their Evolink API Key.
- If the user **does not have a key**, tell them to register at: https://evolink.ai/signup , then go to https://evolink.ai/dashboard/keys to create an API Key.
- Once the user provides the key, save it as a variable in your context for use in subsequent steps. Do NOT use `set` or `export` — they will not persist across Bash calls.

## Instructions

The user wants to generate an image. **If the user did not provide a prompt, ask them first before proceeding.**

Extract the following from their request:
- **prompt**: The image description (required — must ask if missing)
- **size**: Image aspect ratio (optional, default "1:1"). Options: "1:1", "2:3", "3:2", "3:4", "4:3", "9:16", "16:9", "1:2", "2:1", or custom "WxH" (376-1536px)
- **seed**: Random seed for reproducibility (optional)

## Execution

All HTTP operations use `curl`, which is natively available on Windows 10+, macOS, and Linux. User input (prompt) is written to a file via the Write tool to avoid shell escaping issues entirely.

### Step 1: Write the request body to a file

Use the **Write tool** (not Bash) to create a `request.json` file in the current working directory:

```json
{
  "model": "z-image-turbo",
  "prompt": "<USER_PROMPT>",
  "size": "<SIZE>"
}
```

This completely avoids shell escaping — the prompt goes directly into the file, no matter what special characters it contains.

### Step 2: Submit the image generation task

Use the **Bash tool** to run:

```bash
curl -s -X POST "https://api.evolink.ai/v1/images/generations" -H "Authorization: Bearer <API_KEY>" -H "Content-Type: application/json" -d @request.json
```

Parse the `id` field from the JSON response as the task ID.

### Step 3: Poll for task completion

Use the **Bash tool** to poll the task status. Wait ~10 seconds between each call (Claude manages the interval, no shell `sleep` needed):

```bash
curl -s "https://api.evolink.ai/v1/tasks/<TASK_ID>" -H "Authorization: Bearer <API_KEY>"
```

Check the `status` field in the response:
- `pending` or `processing`: poll again (max **200** attempts)
- `completed`: extract the URL from the `results` array, proceed to Step 4
- `failed`: report the error to the user and stop

### Step 4: Download the image

Use the **Bash tool** to download:

```bash
curl -s -o evolink-<TIMESTAMP>.webp "<IMAGE_URL>"
```

Where `<TIMESTAMP>` is the current time in `YYYYMMDDHHmmss` format (generated by Claude when constructing the command).

## Result Handling

After completion, respond to the user:

- **completed**: Show the image URL and confirm the file was downloaded as `evolink-<TIMESTAMP>.webp`. Remind them the URL expires in **72 hours**.
- **failed**: Report the error message from the API.
- **timed out** (200 polls): Inform the user and provide the task ID for manual follow-up.
- **cleanup**: Delete the `request.json` temp file after the task is done.